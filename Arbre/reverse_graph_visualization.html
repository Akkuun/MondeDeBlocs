<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualisation Graphe de Recherche Inverse</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            font-size: 1.2em;
            margin-bottom: 30px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }
        
        .stat-label {
            color: #555;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        .visualization {
            border: 2px solid #ddd;
            border-radius: 10px;
            background: #f8f9fa;
            position: relative;
            overflow: hidden;
        }
        
        .controls {
            padding: 15px;
            background: #e9ecef;
            border-bottom: 1px solid #ddd;
        }
        
        .control-group {
            display: inline-block;
            margin-right: 20px;
        }
        
        label {
            font-weight: bold;
            margin-right: 10px;
        }
        
        select, button {
            padding: 5px 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background: white;
        }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #0056b3;
        }
        
        .legend {
            position: absolute;
            top: 80px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-size: 0.9em;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .tooltip {
            position: absolute;
            text-align: center;
            width: 200px;
            padding: 10px;
            font: 12px sans-serif;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            border: 0px;
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
        }
        
        .node {
            stroke: #fff;
            stroke-width: 2px;
            cursor: pointer;
        }
        
        .link {
            stroke: #999;
            stroke-opacity: 0.6;
            stroke-width: 2px;
            marker-end: url(#arrowhead);
        }
        
        .node.initial {
            stroke: #ff4444;
            stroke-width: 4px;
        }
        
        .path-highlight {
            stroke: #ff4444;
            stroke-width: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÑ Graphe de Recherche Inverse</h1>
        <p class="subtitle">Du but vers l'√©tat initial - Exploration de l'espace d'√©tats</p>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number">115</div>
                <div class="stat-label">N≈ìuds explor√©s</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">4</div>
                <div class="stat-label">Profondeur max</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">4</div>
                <div class="stat-label">√âtapes solution</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">‚úÖ</div>
                <div class="stat-label">Solution trouv√©e</div>
            </div>
        </div>
        
        <div class="visualization">
            <div class="controls">
                <div class="control-group">
                    <label for="layout">Disposition:</label>
                    <select id="layout">
                        <option value="force">Force dirig√©e</option>
                        <option value="tree">Arbre hi√©rarchique</option>
                        <option value="radial">Radiale</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="depth-filter">Profondeur max:</label>
                    <select id="depth-filter">
                        <option value="all">Toutes</option>
                        <option value="0">0</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
                    </select>
                </div>
                <div class="control-group">
                    <button id="highlight-solution">Surligner solution</button>
                    <button id="reset-view">R√©initialiser vue</button>
                </div>
            </div>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #4CAF50;"></div>
                    <span>√âtat initial</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #2196F3;"></div>
                    <span>D√©placement</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #FF9800;"></div>
                    <span>Redresser</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #9C27B0;"></div>
                    <span>Coucher</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #607D8B;"></div>
                    <span>√âtat de d√©part</span>
                </div>
            </div>
            
            <svg id="graph" width="100%" height="800"></svg>
        </div>
    </div>
    
    <script>
        // Graph data
        const graphData = {
            nodes: [
            {
                        "id": 0,
                        "depth": 0,
                        "is_initial": false,
                        "description": "",
                        "action_type": "initial",
                        "children_count": 6,
                        "parent": null
            },
            {
                        "id": 1,
                        "depth": 1,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube violet",
                        "action_type": "move",
                        "children_count": 3,
                        "parent": 0
            },
            {
                        "id": 2,
                        "depth": 1,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Table",
                        "action_type": "move",
                        "children_count": 7,
                        "parent": 0
            },
            {
                        "id": 3,
                        "depth": 1,
                        "is_initial": false,
                        "description": "Coucher Cylindre Tungst\u00e8ne",
                        "action_type": "lay_down",
                        "children_count": 2,
                        "parent": 0
            },
            {
                        "id": 4,
                        "depth": 1,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 3,
                        "parent": 0
            },
            {
                        "id": 5,
                        "depth": 1,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 5,
                        "parent": 0
            },
            {
                        "id": 6,
                        "depth": 1,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Table",
                        "action_type": "move",
                        "children_count": 5,
                        "parent": 0
            },
            {
                        "id": 7,
                        "depth": 2,
                        "is_initial": false,
                        "description": "Coucher Cylindre Tungst\u00e8ne",
                        "action_type": "lay_down",
                        "children_count": 1,
                        "parent": 1
            },
            {
                        "id": 8,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 1,
                        "parent": 1
            },
            {
                        "id": 9,
                        "depth": 2,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 1
            },
            {
                        "id": 10,
                        "depth": 2,
                        "is_initial": false,
                        "description": "Coucher Cylindre Tungst\u00e8ne",
                        "action_type": "lay_down",
                        "children_count": 4,
                        "parent": 2
            },
            {
                        "id": 11,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 7,
                        "parent": 2
            },
            {
                        "id": 12,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 3,
                        "parent": 2
            },
            {
                        "id": 13,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Table",
                        "action_type": "move",
                        "children_count": 7,
                        "parent": 2
            },
            {
                        "id": 14,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 2,
                        "parent": 2
            },
            {
                        "id": 15,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube violet",
                        "action_type": "move",
                        "children_count": 2,
                        "parent": 2
            },
            {
                        "id": 16,
                        "depth": 2,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 2
            },
            {
                        "id": 17,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 4,
                        "parent": 3
            },
            {
                        "id": 18,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Table",
                        "action_type": "move",
                        "children_count": 4,
                        "parent": 3
            },
            {
                        "id": 19,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 1,
                        "parent": 4
            },
            {
                        "id": 20,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 4
            },
            {
                        "id": 21,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 1,
                        "parent": 4
            },
            {
                        "id": 22,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube violet",
                        "action_type": "move",
                        "children_count": 2,
                        "parent": 5
            },
            {
                        "id": 23,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube gris",
                        "action_type": "move",
                        "children_count": 1,
                        "parent": 5
            },
            {
                        "id": 24,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 5
            },
            {
                        "id": 25,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cube violet",
                        "action_type": "move",
                        "children_count": 1,
                        "parent": 5
            },
            {
                        "id": 26,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 1,
                        "parent": 5
            },
            {
                        "id": 27,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube violet",
                        "action_type": "move",
                        "children_count": 5,
                        "parent": 6
            },
            {
                        "id": 28,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube gris",
                        "action_type": "move",
                        "children_count": 3,
                        "parent": 6
            },
            {
                        "id": 29,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 6
            },
            {
                        "id": 30,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cube violet",
                        "action_type": "move",
                        "children_count": 1,
                        "parent": 6
            },
            {
                        "id": 31,
                        "depth": 2,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 1,
                        "parent": 6
            },
            {
                        "id": 32,
                        "depth": 3,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 7
            },
            {
                        "id": 33,
                        "depth": 3,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 8
            },
            {
                        "id": 34,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 2,
                        "parent": 10
            },
            {
                        "id": 35,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Table",
                        "action_type": "move",
                        "children_count": 5,
                        "parent": 10
            },
            {
                        "id": 36,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube violet",
                        "action_type": "move",
                        "children_count": 2,
                        "parent": 10
            },
            {
                        "id": 37,
                        "depth": 3,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 10
            },
            {
                        "id": 38,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 5,
                        "parent": 11
            },
            {
                        "id": 39,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cube violet",
                        "action_type": "move",
                        "children_count": 3,
                        "parent": 11
            },
            {
                        "id": 40,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 1,
                        "parent": 11
            },
            {
                        "id": 41,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 2,
                        "parent": 11
            },
            {
                        "id": 42,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube violet",
                        "action_type": "move",
                        "children_count": 2,
                        "parent": 11
            },
            {
                        "id": 43,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube gris",
                        "action_type": "move",
                        "children_count": 2,
                        "parent": 11
            },
            {
                        "id": 44,
                        "depth": 3,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 11
            },
            {
                        "id": 45,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 12
            },
            {
                        "id": 46,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 12
            },
            {
                        "id": 47,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 12
            },
            {
                        "id": 48,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 4,
                        "parent": 13
            },
            {
                        "id": 49,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cube violet",
                        "action_type": "move",
                        "children_count": 3,
                        "parent": 13
            },
            {
                        "id": 50,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 13
            },
            {
                        "id": 51,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 13
            },
            {
                        "id": 52,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 13
            },
            {
                        "id": 53,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 13
            },
            {
                        "id": 54,
                        "depth": 3,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 13
            },
            {
                        "id": 55,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 14
            },
            {
                        "id": 56,
                        "depth": 3,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 14
            },
            {
                        "id": 57,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 15
            },
            {
                        "id": 58,
                        "depth": 3,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 15
            },
            {
                        "id": 59,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 17
            },
            {
                        "id": 60,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 17
            },
            {
                        "id": 61,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 17
            },
            {
                        "id": 62,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 17
            },
            {
                        "id": 63,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 18
            },
            {
                        "id": 64,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 18
            },
            {
                        "id": 65,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 18
            },
            {
                        "id": 66,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 18
            },
            {
                        "id": 67,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 19
            },
            {
                        "id": 68,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 21
            },
            {
                        "id": 69,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 22
            },
            {
                        "id": 70,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 22
            },
            {
                        "id": 71,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 23
            },
            {
                        "id": 72,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 25
            },
            {
                        "id": 73,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 26
            },
            {
                        "id": 74,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 27
            },
            {
                        "id": 75,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 27
            },
            {
                        "id": 76,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 27
            },
            {
                        "id": 77,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 27
            },
            {
                        "id": 78,
                        "depth": 3,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 27
            },
            {
                        "id": 79,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 28
            },
            {
                        "id": 80,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 28
            },
            {
                        "id": 81,
                        "depth": 3,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 28
            },
            {
                        "id": 82,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 30
            },
            {
                        "id": 83,
                        "depth": 3,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 31
            },
            {
                        "id": 84,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 34
            },
            {
                        "id": 85,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 34
            },
            {
                        "id": 86,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 35
            },
            {
                        "id": 87,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 35
            },
            {
                        "id": 88,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 35
            },
            {
                        "id": 89,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 35
            },
            {
                        "id": 90,
                        "depth": 4,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 35
            },
            {
                        "id": 91,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Cylindre Tungst\u00e8ne sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 36
            },
            {
                        "id": 92,
                        "depth": 4,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 36
            },
            {
                        "id": 93,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 38
            },
            {
                        "id": 94,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 38
            },
            {
                        "id": 95,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 38
            },
            {
                        "id": 96,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 38
            },
            {
                        "id": 97,
                        "depth": 4,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 38
            },
            {
                        "id": 98,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 39
            },
            {
                        "id": 99,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 39
            },
            {
                        "id": 100,
                        "depth": 4,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 39
            },
            {
                        "id": 101,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 40
            },
            {
                        "id": 102,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 41
            },
            {
                        "id": 103,
                        "depth": 4,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 41
            },
            {
                        "id": 104,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube gris sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 42
            },
            {
                        "id": 105,
                        "depth": 4,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 42
            },
            {
                        "id": 106,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Cube violet sur Donut Saucisse",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 43
            },
            {
                        "id": 107,
                        "depth": 4,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 43
            },
            {
                        "id": 108,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 48
            },
            {
                        "id": 109,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube violet",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 48
            },
            {
                        "id": 110,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 48
            },
            {
                        "id": 111,
                        "depth": 4,
                        "is_initial": false,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 48
            },
            {
                        "id": 112,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cylindre Tungst\u00e8ne",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 49
            },
            {
                        "id": 113,
                        "depth": 4,
                        "is_initial": false,
                        "description": "D\u00e9placer Donut Saucisse sur Cube gris",
                        "action_type": "move",
                        "children_count": 0,
                        "parent": 49
            },
            {
                        "id": 114,
                        "depth": 4,
                        "is_initial": true,
                        "description": "Redresser Donut Saucisse",
                        "action_type": "stand_up",
                        "children_count": 0,
                        "parent": 49
            }
],
            links: [
            {
                        "source": 0,
                        "target": 1
            },
            {
                        "source": 0,
                        "target": 2
            },
            {
                        "source": 0,
                        "target": 3
            },
            {
                        "source": 0,
                        "target": 4
            },
            {
                        "source": 0,
                        "target": 5
            },
            {
                        "source": 0,
                        "target": 6
            },
            {
                        "source": 1,
                        "target": 7
            },
            {
                        "source": 1,
                        "target": 8
            },
            {
                        "source": 1,
                        "target": 9
            },
            {
                        "source": 2,
                        "target": 10
            },
            {
                        "source": 2,
                        "target": 11
            },
            {
                        "source": 2,
                        "target": 12
            },
            {
                        "source": 2,
                        "target": 13
            },
            {
                        "source": 2,
                        "target": 14
            },
            {
                        "source": 2,
                        "target": 15
            },
            {
                        "source": 2,
                        "target": 16
            },
            {
                        "source": 3,
                        "target": 17
            },
            {
                        "source": 3,
                        "target": 18
            },
            {
                        "source": 4,
                        "target": 19
            },
            {
                        "source": 4,
                        "target": 20
            },
            {
                        "source": 4,
                        "target": 21
            },
            {
                        "source": 5,
                        "target": 22
            },
            {
                        "source": 5,
                        "target": 23
            },
            {
                        "source": 5,
                        "target": 24
            },
            {
                        "source": 5,
                        "target": 25
            },
            {
                        "source": 5,
                        "target": 26
            },
            {
                        "source": 6,
                        "target": 27
            },
            {
                        "source": 6,
                        "target": 28
            },
            {
                        "source": 6,
                        "target": 29
            },
            {
                        "source": 6,
                        "target": 30
            },
            {
                        "source": 6,
                        "target": 31
            },
            {
                        "source": 7,
                        "target": 32
            },
            {
                        "source": 8,
                        "target": 33
            },
            {
                        "source": 10,
                        "target": 34
            },
            {
                        "source": 10,
                        "target": 35
            },
            {
                        "source": 10,
                        "target": 36
            },
            {
                        "source": 10,
                        "target": 37
            },
            {
                        "source": 11,
                        "target": 38
            },
            {
                        "source": 11,
                        "target": 39
            },
            {
                        "source": 11,
                        "target": 40
            },
            {
                        "source": 11,
                        "target": 41
            },
            {
                        "source": 11,
                        "target": 42
            },
            {
                        "source": 11,
                        "target": 43
            },
            {
                        "source": 11,
                        "target": 44
            },
            {
                        "source": 12,
                        "target": 45
            },
            {
                        "source": 12,
                        "target": 46
            },
            {
                        "source": 12,
                        "target": 47
            },
            {
                        "source": 13,
                        "target": 48
            },
            {
                        "source": 13,
                        "target": 49
            },
            {
                        "source": 13,
                        "target": 50
            },
            {
                        "source": 13,
                        "target": 51
            },
            {
                        "source": 13,
                        "target": 52
            },
            {
                        "source": 13,
                        "target": 53
            },
            {
                        "source": 13,
                        "target": 54
            },
            {
                        "source": 14,
                        "target": 55
            },
            {
                        "source": 14,
                        "target": 56
            },
            {
                        "source": 15,
                        "target": 57
            },
            {
                        "source": 15,
                        "target": 58
            },
            {
                        "source": 17,
                        "target": 59
            },
            {
                        "source": 17,
                        "target": 60
            },
            {
                        "source": 17,
                        "target": 61
            },
            {
                        "source": 17,
                        "target": 62
            },
            {
                        "source": 18,
                        "target": 63
            },
            {
                        "source": 18,
                        "target": 64
            },
            {
                        "source": 18,
                        "target": 65
            },
            {
                        "source": 18,
                        "target": 66
            },
            {
                        "source": 19,
                        "target": 67
            },
            {
                        "source": 21,
                        "target": 68
            },
            {
                        "source": 22,
                        "target": 69
            },
            {
                        "source": 22,
                        "target": 70
            },
            {
                        "source": 23,
                        "target": 71
            },
            {
                        "source": 25,
                        "target": 72
            },
            {
                        "source": 26,
                        "target": 73
            },
            {
                        "source": 27,
                        "target": 74
            },
            {
                        "source": 27,
                        "target": 75
            },
            {
                        "source": 27,
                        "target": 76
            },
            {
                        "source": 27,
                        "target": 77
            },
            {
                        "source": 27,
                        "target": 78
            },
            {
                        "source": 28,
                        "target": 79
            },
            {
                        "source": 28,
                        "target": 80
            },
            {
                        "source": 28,
                        "target": 81
            },
            {
                        "source": 30,
                        "target": 82
            },
            {
                        "source": 31,
                        "target": 83
            },
            {
                        "source": 34,
                        "target": 84
            },
            {
                        "source": 34,
                        "target": 85
            },
            {
                        "source": 35,
                        "target": 86
            },
            {
                        "source": 35,
                        "target": 87
            },
            {
                        "source": 35,
                        "target": 88
            },
            {
                        "source": 35,
                        "target": 89
            },
            {
                        "source": 35,
                        "target": 90
            },
            {
                        "source": 36,
                        "target": 91
            },
            {
                        "source": 36,
                        "target": 92
            },
            {
                        "source": 38,
                        "target": 93
            },
            {
                        "source": 38,
                        "target": 94
            },
            {
                        "source": 38,
                        "target": 95
            },
            {
                        "source": 38,
                        "target": 96
            },
            {
                        "source": 38,
                        "target": 97
            },
            {
                        "source": 39,
                        "target": 98
            },
            {
                        "source": 39,
                        "target": 99
            },
            {
                        "source": 39,
                        "target": 100
            },
            {
                        "source": 40,
                        "target": 101
            },
            {
                        "source": 41,
                        "target": 102
            },
            {
                        "source": 41,
                        "target": 103
            },
            {
                        "source": 42,
                        "target": 104
            },
            {
                        "source": 42,
                        "target": 105
            },
            {
                        "source": 43,
                        "target": 106
            },
            {
                        "source": 43,
                        "target": 107
            },
            {
                        "source": 48,
                        "target": 108
            },
            {
                        "source": 48,
                        "target": 109
            },
            {
                        "source": 48,
                        "target": 110
            },
            {
                        "source": 48,
                        "target": 111
            },
            {
                        "source": 49,
                        "target": 112
            },
            {
                        "source": 49,
                        "target": 113
            },
            {
                        "source": 49,
                        "target": 114
            }
]
        };
        
        // Color mapping for different action types
        const colorMap = {
            'initial': '#4CAF50',    // Green for initial state
            'move': '#2196F3',       // Blue for movements
            'stand_up': '#FF9800',   // Orange for stand up
            'lay_down': '#9C27B0',   // Purple for lay down
            'goal': '#607D8B'        // Gray for goal state
        };
        
        // Initialize visualization
        const svg = d3.select("#graph");
        const width = parseInt(svg.style("width"));
        const height = parseInt(svg.style("height"));
        
        // Create tooltip
        const tooltip = d3.select("body").append("div")
            .attr("class", "tooltip");
        
        // Add arrow marker
        svg.append("defs").append("marker")
            .attr("id", "arrowhead")
            .attr("viewBox", "0 -5 10 10")
            .attr("refX", 20)
            .attr("refY", 0)
            .attr("markerWidth", 6)
            .attr("markerHeight", 6)
            .attr("orient", "auto")
            .append("path")
            .attr("d", "M0,-5L10,0L0,5")
            .attr("fill", "#999");
        
        let simulation, link, node;
        
        function initializeVisualization() {
            svg.selectAll("*").remove();
            
            // Re-add arrow marker after clearing
            svg.append("defs").append("marker")
                .attr("id", "arrowhead")
                .attr("viewBox", "0 -5 10 10")
                .attr("refX", 20)
                .attr("refY", 0)
                .attr("markerWidth", 6)
                .attr("markerHeight", 6)
                .attr("orient", "auto")
                .append("path")
                .attr("d", "M0,-5L10,0L0,5")
                .attr("fill", "#999");
            
            const layout = d3.select("#layout").property("value");
            const maxDepth = d3.select("#depth-filter").property("value");
            
            // Filter nodes and links based on depth
            let filteredNodes = graphData.nodes;
            let filteredLinks = graphData.links;
            
            if (maxDepth !== "all") {
                const depthLimit = parseInt(maxDepth);
                filteredNodes = graphData.nodes.filter(d => d.depth <= depthLimit);
                const nodeIds = new Set(filteredNodes.map(d => d.id));
                filteredLinks = graphData.links.filter(d => nodeIds.has(d.source) && nodeIds.has(d.target));
            }
            
            // Create links
            link = svg.append("g")
                .selectAll("line")
                .data(filteredLinks)
                .join("line")
                .attr("class", "link");
            
            // Create nodes
            node = svg.append("g")
                .selectAll("circle")
                .data(filteredNodes)
                .join("circle")
                .attr("class", d => `node ${d.is_initial ? 'initial' : ''}`)
                .attr("r", d => d.is_initial ? 12 : (8 + d.children_count))
                .attr("fill", d => colorMap[d.action_type] || "#999")
                .on("mouseover", function(event, d) {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`
                        <strong>N≈ìud ${d.id}</strong><br/>
                        Profondeur: ${d.depth}<br/>
                        ${d.description || "√âtat de d√©part"}<br/>
                        Enfants: ${d.children_count}
                    `)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            // Setup simulation based on layout
            if (layout === "force") {
                simulation = d3.forceSimulation(filteredNodes)
                    .force("link", d3.forceLink(filteredLinks).id(d => d.id).distance(100))
                    .force("charge", d3.forceManyBody().strength(-300))
                    .force("center", d3.forceCenter(width / 2, height / 2))
                    .force("collision", d3.forceCollide().radius(d => d.is_initial ? 15 : 12));
                
                simulation.on("tick", () => {
                    link
                        .attr("x1", d => d.source.x)
                        .attr("y1", d => d.source.y)
                        .attr("x2", d => d.target.x)
                        .attr("y2", d => d.target.y);
                    
                    node
                        .attr("cx", d => Math.max(15, Math.min(width - 15, d.x)))
                        .attr("cy", d => Math.max(15, Math.min(height - 15, d.y)));
                });
                
                // Add drag behavior
                node.call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended));
            } else if (layout === "tree") {
                // Tree layout
                const root = d3.stratify()
                    .id(d => d.id)
                    .parentId(d => d.parent)
                    (filteredNodes);
                
                const treeLayout = d3.tree().size([width - 100, height - 100]);
                treeLayout(root);
                
                node
                    .attr("cx", d => d.x + 50)
                    .attr("cy", d => d.y + 50);
                
                link
                    .attr("x1", d => {
                        const source = filteredNodes.find(n => n.id === d.source);
                        return root.descendants().find(n => n.id == source.id).x + 50;
                    })
                    .attr("y1", d => {
                        const source = filteredNodes.find(n => n.id === d.source);
                        return root.descendants().find(n => n.id == source.id).y + 50;
                    })
                    .attr("x2", d => {
                        const target = filteredNodes.find(n => n.id === d.target);
                        return root.descendants().find(n => n.id == target.id).x + 50;
                    })
                    .attr("y2", d => {
                        const target = filteredNodes.find(n => n.id === d.target);
                        return root.descendants().find(n => n.id == target.id).y + 50;
                    });
            }
        }
        
        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }
        
        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }
        
        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }
        
        function highlightSolution() {
            // Find solution path
            const solutionNode = graphData.nodes.find(d => d.is_initial);
            if (!solutionNode) return;
            
            const solutionPath = [];
            let current = solutionNode;
            
            while (current && current.parent !== null) {
                solutionPath.push(current.id);
                current = graphData.nodes.find(d => d.id === current.parent);
            }
            if (current) solutionPath.push(current.id);
            
            // Highlight solution path
            node.classed("path-highlight", d => solutionPath.includes(d.id));
            link.classed("path-highlight", d => 
                solutionPath.includes(d.source.id || d.source) && 
                solutionPath.includes(d.target.id || d.target)
            );
        }
        
        function resetView() {
            node.classed("path-highlight", false);
            link.classed("path-highlight", false);
        }
        
        // Event listeners
        d3.select("#layout").on("change", initializeVisualization);
        d3.select("#depth-filter").on("change", initializeVisualization);
        d3.select("#highlight-solution").on("click", highlightSolution);
        d3.select("#reset-view").on("click", resetView);
        
        // Initialize
        initializeVisualization();
    </script>
</body>
</html>